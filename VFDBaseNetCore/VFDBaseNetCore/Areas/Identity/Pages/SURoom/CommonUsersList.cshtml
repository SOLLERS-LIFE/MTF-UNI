@page
@model MTF.Areas.Identity.Pages.SURoom.CommonUsersListModel

@{
    ViewData["Title"] = Model.PageName;
    Layout = "~/Pages/Shared/_Layout.cshtml";
    
    var NavHeight = MTF.GlobalParameters.NavbarHeight;
    var invSortDirection = @Model._invariants.SortDirection ?? "_desc";
    invSortDirection = invSortDirection == "_desc" ? "_" : "_desc";
}

@using (Html.BeginForm("CommonUsersList", "", FormMethod.Post,
                 new { id = "tableForm", name = "tableForm" }
                 )
 )
{ 
}
<div class="container-fluid mx-0 px-0">
    <partial name="~/Pages/Shared/_statusMessage.cshtml" model="@Model._statusMessage" />
    <div class="table-responsive overflow-auto table-for-sticky">
        <table class="table table-sm table-striped table-hover table-bordered mb-0">
            <thead class="table-light">
                <tr>
                    <th class="align-middle" scope="col" style="width: 35%">
                        <a class="text-th"
                            asp-page="./CommonUsersList"
                            asp-route-prevSortOrder="@Model._invariants.CurrentSort"
                            asp-route-newSortOrder="sortA"
                            asp-route-prevSortDirection="@Model._invariants.SortDirection"
                            asp-route-pageIndex=1
                            asp-route-searchString="@Model._invariants.CurrentFilter"
                            asp-route-pageSize="@Model._invariants.CurrentPageSize"
                            asp-route-workFlowId="@Model._invariants.WorkFlowId"
                            asp-route-searchRole="@Model._invariants.CurrentRole"
                            asp-route-prevSearchRole="@Model._invariants.CurrentRole"
                            asp-route-searchField="@Model._invariants.CurrentSearchField">
                            @Html.DisplayNameFor(model => model.CommonUsersPage[0].Email)
                            @if (Model._invariants.CurrentSort == "sortA")
                            {
                                if (Model._invariants.SortDirection == "_")
                                {
                                    <span class="fas fa-sort-alpha-down fa-lg"></span>
                                }
                                else
                                {
                                    <span class="fas fa-sort-alpha-down-alt fa-lg"></span>
                                }
                            }
                        </a>
                    </th>
                    <th class="align-middle" scope="col" style="width: 20%">
                        <a class="text-th"
                            asp-page="./CommonUsersList"
                            asp-route-prevSortOrder="@Model._invariants.CurrentSort"
                            asp-route-newSortOrder="sortB"
                            asp-route-prevSortDirection="@Model._invariants.SortDirection"
                            asp-route-pageIndex="1"
                            asp-route-searchString="@Model._invariants.CurrentFilter"
                            asp-route-pageSize="@Model._invariants.CurrentPageSize"
                            asp-route-workFlowId="@Model._invariants.WorkFlowId"
                            asp-route-searchRole="@Model._invariants.CurrentRole"
                            asp-route-prevSearchRole="@Model._invariants.CurrentRole"
                            asp-route-searchField="@Model._invariants.CurrentSearchField">
                            @Html.DisplayNameFor(model => model.CommonUsersPage[0].FullName)
                            @if (Model._invariants.CurrentSort == "sortB")
                            {
                                if (Model._invariants.SortDirection == "_")
                                {
                                    <span class="fas fa-sort-alpha-down fa-lg"></span>
                                }
                                else
                                {
                                    <span class="fas fa-sort-alpha-down-alt fa-lg"></span>
                                }
                            }
                        </a>
                    </th>
                    <th class="align-middle" scope="col">
                        <a class="text-th"
                            asp-page="./CommonUsersList"
                            asp-route-prevSortOrder="@Model._invariants.CurrentSort"
                            asp-route-newSortOrder="sortC"
                            asp-route-prevSortDirection="@Model._invariants.SortDirection"
                            asp-route-pageIndex="1"
                            asp-route-searchString="@Model._invariants.CurrentFilter"
                            asp-route-pageSize="@Model._invariants.CurrentPageSize"
                            asp-route-workFlowId="@Model._invariants.WorkFlowId"
                            asp-route-searchRole="@Model._invariants.CurrentRole"
                            asp-route-prevSearchRole="@Model._invariants.CurrentRole"
                            asp-route-searchField="@Model._invariants.CurrentSearchField">
                            @Html.DisplayNameFor(model => model.CommonUsersPage[0].PhoneNumber)
                            @if (Model._invariants.CurrentSort == "sortC")
                            {
                                if (Model._invariants.SortDirection == "_")
                                {
                                    <span class="fas fa-sort-alpha-down fa-lg"></span>
                                }
                                else
                                {
                                    <span class="fas fa-sort-alpha-down-alt fa-lg"></span>
                                }
                            }
                        </a>
                    </th>
                    <th class="align-middle text-primary" scope="col" style="width: 8%">
                        <a class="text-th"
                            asp-page="./CommonUsersList"
                            asp-route-prevSortOrder="@Model._invariants.CurrentSort"
                            asp-route-newSortOrder="sortD"
                            asp-route-prevSortDirection="@Model._invariants.SortDirection"
                            asp-route-pageIndex="1"
                            asp-route-searchString="@Model._invariants.CurrentFilter"
                            asp-route-pageSize="@Model._invariants.CurrentPageSize"
                            asp-route-workFlowId="@Model._invariants.WorkFlowId"
                            asp-route-searchRole="@Model._invariants.CurrentRole"
                            asp-route-prevSearchRole="@Model._invariants.CurrentRole"
                            asp-route-searchField="@Model._invariants.CurrentSearchField">
                            @* @Html.DisplayNameFor(model => model.CommonUsersPage[0].LockoutEnd) *@
                            <span>reserved</span>
                            @if (Model._invariants.CurrentSort == "sortD")
                            {
                                if (Model._invariants.SortDirection == "_")
                                {
                                    <span class="fas fa-sort-alpha-down fa-lg"></span>
                                }
                                else
                                {
                                    <span class="fas fa-sort-alpha-down-alt fa-lg"></span>
                                }
                            }
                        </a>
                    </th>
                    <th class="align-middle" scope="col" style="width: 2%">
                        @Html.HiddenFor(m => m._invariants.WorkFlowId)
                        @Html.HiddenFor(m => m._invariants.CurrentSort)
                        @Html.HiddenFor(m => m._invariants.SortDirection)
                        @Html.HiddenFor(m => m._invariants.CurrentFilter)
                        @Html.HiddenFor(m => m._invariants.CurrentPageSize)
                        @Html.HiddenFor(m => m._invariants.CurrentRole)
                        @Html.HiddenFor(m => m._invariants.CurrentSearchField)
                        @Html.HiddenFor(m => m._invariants.PageIndex)
                        @Html.HiddenFor(m => m._invariants.TotalPages)
                    </th>
                </tr>
            </thead>
            <tbody class="blue-grey lighten-5">
                @for (int i = 0; i < Model.CommonUsersPage.Count; i++) //var item in Model.CommonUserPg)
                {
                    <tr ondblclick="usersListDblclick('@Model.CommonUsersPage[i].UserId')">
                        <td class="td-wrapword ms-1 me-0 ps-1 pe-0">
                            <div class="font-weight-bolder  text-info">
                                @Html.DisplayFor(m => m.CommonUsersPage[i].Email)
                            </div>
                        </td>
                        <td class="td-wrapword ms-1 me-0 ps-1 pe-0">
                            <div class="font-weight-bolder">
                                @Html.DisplayFor(m => m.CommonUsersPage[i].FullName)
                            </div>
                        </td>
                        <td class="td-wrapword ms-1 me-0 ps-1 pe-0">
                            <div class="font-weight-bolder  text-info">
                                @Html.DisplayFor(m => m.CommonUsersPage[i].PhoneNumber)
                            </div>
                        </td>
                        <td class="td-wrapword ms-1 me-0 ps-1 pe-0">
                            <div class="font-weight-bolder">
                                @Html.DisplayFor(m => m.CommonUsersPage[i].LockoutEnd)
                            </div>
                        </td>
                        <td class="text-center ms-0 me-0 ps-0 pe-0">
                            <a asp-area="Identity" asp-page="/Account/Manage/Index" asp-route-id="@Model.CommonUsersPage[i].UserId"
                                class="">
                                <span class="fas fa-external-link-alt fa-lg" aria-hidden="true"></span>
                            </a>
                            @Html.HiddenFor(m => m.CommonUsersPage[i].UserId)
                        </td>
                    </tr>

                }
            </tbody>
        </table>
    </div>
</div>

<partial name="./_UsersSearchSortAndPagingAdv.cshtml" />

<script type="text/javascript">
    function usersListDblclick(entryId) {
        //window.alert(entryId);
        window.location.href = '/Identity/Account/Manage?id='+entryId;
    }

    // block browser vertical scrollbar
    unloadBrowserScrollBars();
</script>

